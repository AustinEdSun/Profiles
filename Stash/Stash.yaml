# Stash é…ç½®

# Port of HTTP(S) æœ¬åœ°ä»£ç†æœåŠ¡å™¨
port: 7890

# Port of SOCKS5 æœ¬åœ°ä»£ç†æœåŠ¡å™¨
socks-port: 7891

# é€‚ç”¨äº Linux å’Œ macOS çš„é€æ˜ä»£ç†æœåŠ¡å™¨ç«¯å£ï¼ˆRedirect TCP å’Œ TProxy UDPï¼‰
# redir-port: 7892

# HTTP(S) and SOCKS4(A)/SOCKS5 æœåŠ¡å™¨åœ¨åŒä¸€ä¸ªç«¯å£
# mixed-port: 7893

# è®¾ç½®ä¸º true ä»¥å…è®¸ä»æœ¬åœ°è¿æ¥åˆ°æœ¬åœ°æœåŠ¡å™¨
allow-lan: false
# è¿™ä»…åœ¨ allow-lan ä¸º true æ—¶é€‚ç”¨
# '*': ç»‘å®šæ‰€æœ‰IPåœ°å€
bind-address: '*'

# è§„åˆ™æ¨¡å¼ï¼šruleï¼ˆè§„åˆ™ï¼‰ / globalï¼ˆå…¨å±€ä»£ç†ï¼‰/ directï¼ˆå…¨å±€ç›´è¿ï¼‰
mode: rule

# è®¾ç½®æ—¥å¿—è¾“å‡ºçº§åˆ« (é»˜è®¤çº§åˆ«ï¼šsilentï¼Œå³ä¸è¾“å‡ºä»»ä½•å†…å®¹ï¼Œä»¥é¿å…å› æ—¥å¿—å†…å®¹è¿‡å¤§è€Œå¯¼è‡´ç¨‹åºå†…å­˜æº¢å‡ºï¼‰ã€‚
# 5 ä¸ªçº§åˆ«ï¼šsilent / info / warning / error / debugã€‚çº§åˆ«è¶Šé«˜æ—¥å¿—è¾“å‡ºé‡è¶Šå¤§ï¼Œè¶Šå€¾å‘äºè°ƒè¯•ï¼Œè‹¥éœ€è¦è¯·è‡ªè¡Œå¼€å¯ã€‚
log-level: warning
# å½“è®¾ç½®ä¸º false æ—¶ï¼Œè§£æå™¨ä¸ä¼šå°†ä¸»æœºåè½¬æ¢ä¸º IPv6 åœ°å€
ipv6: false

# RESTful Web API ç›‘å¬åœ°å€
external-controller: 127.0.0.1:9090

# Stashè·å–æœºåœºæµé‡ä¿¡æ¯å¹¶åœ¨ä¸»é¡µæ˜¾ç¤º(Stash1.6.1 build287+æ”¯æŒ)
subscribe-url: https://sub.store/download/collection/Stash

# DNSè®¾ç½®
dns:
  enable: true
  listen: 0.0.0.0:53
  # è¿™äº›åç§°æœåŠ¡å™¨ç”¨äºè§£æä¸‹é¢çš„ DNS åç§°æœåŠ¡å™¨ä¸»æœºåã€‚
  # ä»…æŒ‡å®š IP åœ°å€
  default-nameserver:
    - 119.29.29.29
    - 223.5.5.5
  # DoHæœåŠ¡å™¨
  nameserver:
    - https://dns.alidns.com/dns-query
    - https://doh.dns.sb/dns-query
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  # åˆ—è¡¨ä¸­çš„åŸŸåå°†ä¸ä¼šè¢«è§£æä¸ºfake ipï¼Œè¿™äº›åŸŸåç›¸å…³çš„è§£æè¯·æ±‚å°†ä¼šè¿”å›å®ƒä»¬çœŸå®çš„IPåœ°å€
  fake-ip-filter:
    - '*.lan'
    - localhost.ptlogin2.qq.com
    - '+.srv.nintendo.net'
    - '+.stun.playstation.net'
    - '+.msftconnecttest.com'
    - '+.msftncsi.com'
    - '+.xboxlive.com'
    - 'msftconnecttest.com'
    - 'xbox.*.microsoft.com'
    - '*.battlenet.com.cn'
    - '*.battlenet.com'
    - '*.blzstatic.cn'
    - '*.battle.net'

# æœ¬åœ°ä»£ç†
proxies:

# è¿œç¨‹è®¢é˜…(ä»£ç†é›†åˆ)
proxy-providers:

  # æ‰‹åŠ¨é€‰æ‹©
  MyProxy: &Stash #å»ºç«‹é”šç‚¹
    type: http
    url: "https://sub.store/download/collection/Stash"
    # å¤šæœºåœºç”¨æˆ·è¯·ä½¿ç”¨Sub-Storeç”Ÿæˆè‡ªå·±çš„è®¢é˜…åœ°å€å¹¶æ›¿æ¢ä»¥ä¸‹urlåœ°å€
    # ä¹Ÿå¯ä»¥ä½¿ç”¨ä»»æ„ç±»å‹çš„é“¾æ¥æ›¿æ¢urlåœ°å€ï¼Œå¤šä¸ªé“¾æ¥ä½¿ç”¨è‹±æ–‡ç¬¦å·çš„ç«–æ |éš”å¼€ä¸€èµ·å†™ä¸Šå³å¯ï¼›
    # æˆ–è€…å°†Clashè®¢é˜…é“¾æ¥æ›¿æ¢æ‰æ•´ä¸ªå¼•å·""å†…çš„é“¾æ¥
    interval: 3600
    path: ./proxy_providers/MyProxy.yaml
    health-check:
      enable: true
      interval: 600
      url: http://cp.cloudflare.com/generate_204
  
  # æ•…éšœåˆ‡æ¢
  MyProxy-Fallback:
    <<: *Stash #å¼•ç”¨é”šç‚¹å†…å®¹
    filter: "é¦™æ¸¯|HK|Hong Kong|æ—¥æœ¬|JP|Japan"
  
  # Netflix
  MyProxy-Netflix:
    <<: *Stash #å¼•ç”¨é”šç‚¹å†…å®¹
    filter: "æ–°åŠ å¡|ç‹®åŸ|SG|Singapore|æ—¥æœ¬|JP|Japan"
    
  # å›½é™…æµåª’ä½“æœåŠ¡
  MyProxy-Streaming:
    <<: *Stash #å¼•ç”¨é”šç‚¹å†…å®¹
    filter: "æ–°åŠ å¡|ç‹®åŸ|SG|Singapore|é¦™æ¸¯|HK|Hong Kong|æ—¥æœ¬|JP|Japan"
  
  # ä¸­å›½æµåª’ä½“æœåŠ¡ï¼ˆé¢å‘æµ·å¤–ç‰ˆæœ¬ï¼‰
  MyProxy-StreamingSE:
    <<: *Stash #å¼•ç”¨é”šç‚¹å†…å®¹
    filter: "é¦™æ¸¯|HK|Hong Kong|å°æ¹¾|TW|Taiwan"
    
  #é¦™æ¸¯èŠ‚ç‚¹
  MyProxy-HK:
    <<: *Stash #å¼•ç”¨é”šç‚¹å†…å®¹
    filter: "é¦™æ¸¯|HK|Hong Kong"
    
  #å°æ¹¾èŠ‚ç‚¹  
  MyProxy-TW:
    <<: *Stash #å¼•ç”¨é”šç‚¹å†…å®¹
    filter: "å°æ¹¾|TW|Taiwan"
    
  #æ–°åŠ å¡èŠ‚ç‚¹  
  MyProxy-SG:
    <<: *Stash #å¼•ç”¨é”šç‚¹å†…å®¹
    filter: "æ–°åŠ å¡|ç‹®åŸ|SG|Singapore"
    
  #æ—¥æœ¬èŠ‚ç‚¹  
  MyProxy-JP:
    <<: *Stash #å¼•ç”¨é”šç‚¹å†…å®¹
    filter: "æ—¥æœ¬|JP|Japan"

  #ç¾å›½èŠ‚ç‚¹
  MyProxy-US:
    <<: *Stash #å¼•ç”¨é”šç‚¹å†…å®¹
    filter: "ç¾å›½|US|United States"
  
#ç­–ç•¥ç»„
proxy-groups:

- name: Option
  type: select
  icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/Urltest.png
  proxies:
    - ğŸ‡­ğŸ‡° Hong Kong
    - ğŸ‡¨ğŸ‡³ Taiwan
    - ğŸ‡¯ğŸ‡µ Japan
    - ğŸ‡¸ğŸ‡¬ Singapore
    - ğŸ‡ºğŸ‡¸ United States
    - Fallback
    - NodeList
    - DIRECT

- name: NodeList
  type: select
  icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/Static.png
  use:
    - MyProxy

- name: Fallback
  type: fallback
  icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/Available.png
  use:
    - MyProxy-Fallback

- name: Netflix
  type: select
  icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Netflix.png
  proxies:
    - ğŸ‡¸ğŸ‡¬ Singapore
    - ğŸ‡¯ğŸ‡µ Japan
  use:
    - MyProxy-Netflix
    
- name: Streaming
  type: select
  icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/ForeignMedia.png
  proxies:
    - ğŸ‡¸ğŸ‡¬ Singapore
    - ğŸ‡­ğŸ‡° Hong Kong
    - ğŸ‡¯ğŸ‡µ Japan
  use:
    - MyProxy-Streaming

- name: StreamingSE
  type: select
  icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/HKMTMedia.png
  proxies:
    - DIRECT
    - ğŸ‡­ğŸ‡° Hong Kong
    - ğŸ‡¨ğŸ‡³ Taiwan
  use:
    - MyProxy-StreamingSE

- name: AdBlock
  type: select
  icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Advertising.png
  proxies:
    - REJECT
    - Option
    - DIRECT

- name: Final
  type: select
  icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Final.png
  proxies:
    - Option
    - NodeList
    - DIRECT

- name: ğŸ‡­ğŸ‡° Hong Kong
  type: fallback
  icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Hong_Kong.png
  use:
      - MyProxy-HK

- name: ğŸ‡¨ğŸ‡³ Taiwan
  type: fallback
  icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/China.png
  use:
      - MyProxy-TW

- name: ğŸ‡¸ğŸ‡¬ Singapore
  type: fallback
  icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Singapore.png
  use:
      - MyProxy-SG

- name: ğŸ‡¯ğŸ‡µ Japan
  type: fallback
  icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Japan.png
  use:
      - MyProxy-JP

- name: ğŸ‡ºğŸ‡¸ United States
  type: fallback
  icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/United_States.png
  use:
      - MyProxy-US
      
#è¿œç¨‹è§„åˆ™é›†åˆå£°æ˜
rule-providers:

# Direct ç›´è¿æŒ‡ä¸åº”è¯¥è¢«å»å¹¿å‘Šåˆ†æµè§„åˆ™å±è”½çš„åŸŸåã€IPç­‰ï¼Œè¯·å°†æ­¤åˆ†æµè§„åˆ™ç½®äºå»å¹¿å‘Šè§„åˆ™ä¹‹å‰ã€‚
  Direct-rules:
    type: http
    behavior: classical
    interval: 86400
    name: Direct
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Direct/Direct.yaml
    path: ./ruleset/direct.yaml
    
# Advertising å¹¿å‘Š
  # Advertising-rules:
  #   type: http
  #   behavior: classical
  #   interval: 86400
  #   name: Advertising
  #   url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Advertising/Advertising.yaml
  #   path: ./ruleset/Advertising.yaml

  # AdvertisingDomain-rules:
  #   type: http
  #   behavior: domain
  #   interval: 86400
  #   name: AdvertisingDomain
  #   url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Advertising/Advertising_Domain.yaml
  #   path: ./ruleset/AdvertisingDomain.yaml
    
  AdvertisingLiteDomain-rules:
    type: http
    behavior: domain
    interval: 86400
    name: AdvertisingLiteDomain
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/AdvertisingLite/AdvertisingLite_Domain.yaml
    path: ./ruleset/AdvertisingLiteDomain.yaml
    
# > æµ·å¤–æµåª’ä½“
# Netflix
  Netflix-rules:
    type: http
    behavior: classical
    interval: 86400
    name: Netflix
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Netflix/Netflix.yaml
    path: ./ruleset/Netflix.yaml

# Disney+
  # Disney-rules:
  #   type: http
  #   behavior: classical
  #   interval: 86400
  #   name: Disney+
  #   url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Disney/Disney.yaml
  #   path: ./ruleset/Disney.yaml
    
# HBO
  # HBO-rules:
  #   type: http
  #   behavior: classical
  #   interval: 86400
  #   name: HBO
  #   url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/HBO/HBO.yaml
  #   path: ./ruleset/HBO.yaml
    
# YouTube
  # YouTube-rules:
  #   type: http
  #   behavior: classical
  #   interval: 86400
  #   name: YouTube
  #   url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/YouTube/YouTube.yaml
  #   path: ./ruleset/YouTube.yaml
    
# Spotify
  # Spotify-rules:
  #   type: http
  #   behavior: classical
  #   interval: 86400
  #   name: Spotify
  #   url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Spotify/Spotify.yaml
  #   path: ./ruleset/Spotify.yaml
    
# TikTok
  # TikTok-rules:
  #   type: http
  #   behavior: classical
  #   interval: 86400
  #   name: TikTok
  #   url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/TikTok/TikTok.yaml
  #   path: ./ruleset/TikTok.yaml

# Streaming å›½é™…æµåª’ä½“æœåŠ¡
  # Streaming-rules:
  #   type: http
  #   behavior: classical
  #   interval: 86400
  #   name: Streaming
  #   url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/GlobalMedia/GlobalMedia.yaml
  #   path: ./ruleset/GlobalMedia.yaml

  StreamingDomain-rules:
    type: http
    behavior: domain
    interval: 86400
    name: StreamingDomain
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/GlobalMedia/GlobalMedia_Domain.yaml
    path: ./ruleset/GlobalMedia_Domain.yaml

# > æ¸¯æ¾³å°æµåª’ä½“
# StreamingSE ä¸­å›½å¤§é™†æµåª’ä½“æœåŠ¡ï¼ˆé¢å‘æ¸¯æ¾³å°æˆ–æµ·å¤–ç‰ˆæœ¬ï¼‰
  StreamingSE-rules:
    type: http
    behavior: classical
    interval: 86400
    name: StreamingSE
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/AsianMedia/AsianMedia.yaml
    path: ./ruleset/AsianMedia.yaml

# > è½¯ä»¶&æœåŠ¡
# WeChat
  WeChat-rules:
    type: http
    behavior: classical
    interval: 86400
    name: WeChat
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/WeChat/WeChat.yaml
    path: ./ruleset/WeChat.yaml
    
# Weibo
  Weibo-rules:
    type: http
    behavior: classical
    interval: 86400
    name: Weibo
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Weibo/Weibo.yaml
    path: ./ruleset/Weibo.yaml
    
# Apple
  Apple-rules:
    type: http
    behavior: classical
    interval: 86400
    name: Apple
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Apple/Apple.yaml
    path: ./ruleset/Apple.yaml
    
# Microsoft
  Microsoft-rules:
    type: http
    behavior: classical
    interval: 86400
    name: Microsoft
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Microsoft/Microsoft.yaml
    path: ./ruleset/Microsoft.yaml
    
# Google
  Google-rules:
    type: http
    behavior: classical
    interval: 86400
    name: Google
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Google/Google.yaml
    path: ./ruleset/Google.yaml
    
# Telegram
  Telegram-rules:
    type: http
    behavior: classical
    interval: 86400
    name: Telegram
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Telegram/Telegram.yaml
    path: ./ruleset/Telegram.yaml

# Global å…¨çƒåŠ é€Ÿ
  # Global-rules:
  #   type: http
  #   behavior: classical
  #   interval: 86400
  #   name: Global
  #   url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Global/Global.yaml
  #   path: ./ruleset/Global.yaml

  GlobalDomain-rules:
    type: http
    behavior: domain
    interval: 86400
    name: GlobalDomain
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Global/Global_Domain.yaml
    path: ./ruleset/Global_Domain.yaml

# China ä¸­å›½å¤§é™†ç›´è¿
  China-rules:
    type: http
    behavior: classical
    interval: 86400
    name: China
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/China/China.yaml
    path: ./ruleset/China.yaml

#åˆ†æµè§„åˆ™å¼•ç”¨
rules:
- RULE-SET,Direct-rules,DIRECT
# - RULE-SET,Advertising-rules,AdBlock
# - RULE-SET,AdvertisingDomain-rules,AdBlock
- RULE-SET,AdvertisingLiteDomain-rules,AdBlock
- RULE-SET,Netflix-rules,Netflix
# - RULE-SET,Disney-rules,Disney+
# - RULE-SET,HBO-rules,HBO
# - RULE-SET,YouTube-rules,YouTube
# - RULE-SET,Spotify-rules,Spotify
# - RULE-SET,TikTok-rules,TikTok
# - RULE-SET,Streaming-rules,Streaming
- RULE-SET,StreamingDomain-rules,Streaming
- RULE-SET,StreamingSE-rules,StreamingSE
- RULE-SET,WeChat-rules,DIRECT
- RULE-SET,Weibo-rules,DIRECT
- RULE-SET,Apple-rules,DIRECT
- RULE-SET,Microsoft-rules,DIRECT
- RULE-SET,Google-rules,Option
- RULE-SET,Telegram-rules,Option
# - RULE-SET,Global-rules,Option
- RULE-SET,GlobalDomain-rules,Option
- RULE-SET,China-rules,DIRECT
# Local Area Network å±€åŸŸç½‘
- DOMAIN,localhost,DIRECT
- DOMAIN-SUFFIX,local,DIRECT
- IP-CIDR,192.168.0.0/16,DIRECT
- IP-CIDR,10.0.0.0/8,DIRECT
- IP-CIDR,172.16.0.0/12,DIRECT
# æŠ–éŸ³æœ¬åœ°åˆ†æµ
- DOMAIN-SUFFIX,snssdk.com,DIRECT
- DOMAIN-SUFFIX,amemv.com,DIRECT
# GeoIP China
- GEOIP,CN,DIRECT
- MATCH,Fina
